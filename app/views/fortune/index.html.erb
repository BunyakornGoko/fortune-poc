<% content_for :title, "‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ - Chinese Fortune" %>
<% content_for :full_page, true %>
<% content_for :head do %>
  <%= stylesheet_link_tag "fortune", "data-turbo-track": "reload" %>
<% end %>

<div class="fortune-container">
  <!-- Background Music -->
  <audio id="bgMusic" loop>
    <source src="<%= audio_path('chinese_background.mp3') %>" type="audio/mpeg">
  </audio>
  
  <!-- Music Control Button -->
  <button id="musicToggle" class="music-control" aria-label="‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏á">
    <span class="music-icon">üéµ</span>
  </button>

  <!-- Header with Chinese decorations -->
  <div class="header-section">
    <div class="chinese-ornament">Èæç</div>
    <h1 class="main-title">
      <span class="chinese-text">Ê±ÇÁ±§ÂïèÂçú</span>
      <span class="thai-text">‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ ‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå ‡∏£‡∏±‡∏ö‡πÇ‡∏ä‡∏Ñ</span>
    </h1>
    <div class="chinese-ornament">È≥≥</div>
  </div>

  <!-- Fortune Stick Container -->
  <div class="fortune-stick-container">
    <div class="temple-background">
      <div class="incense-smoke"></div>
      <div class="incense-smoke delay-1"></div>
      <div class="incense-smoke delay-2"></div>
    </div>
    
    <div class="fortune-sticks" id="fortuneSticks">
      <% 20.times do |i| %>
        <div class="stick stick-<%= i + 1 %>" data-stick="<%= i + 1 %>">
          <div class="stick-tip-number"><%= i + 1 %></div>
        </div>
      <% end %>
    </div>
    
    <div class="fortune-box">
      <div class="box-decoration">Á¶è</div>
    </div>
  </div>

  <!-- Action Button -->
  <div class="action-section">
    <div class="category-section">
      <label for="categorySelect" class="category-label">‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢:</label>
      <select id="categorySelect" class="category-select" aria-label="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏≥‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢">
        <option value="study">‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</option>
        <option value="love">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏±‡∏Å</option>
        <option value="health">‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</option>
        <option value="finance">‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô</option>
      </select>
    </div>

    <button id="drawFortuneBtn" class="draw-fortune-btn">
      <span class="btn-chinese">Ê±ÇÁ±§</span>
      <span class="btn-thai">‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ</span>
      <div class="btn-glow"></div>
    </button>
  </div>

  <!-- Fortune Result (Modal) -->
  <div id="fortuneResult" class="fortune-result modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="fortuneTitle">
    <div class="result-container">
      <div class="fortune-paper">
        <button id="closeResultBtn" class="modal-close-btn" aria-label="‡∏õ‡∏¥‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå">√ó</button>
        <div class="paper-header">
          <span class="paper-ornament">‚óÜ</span>
          <span id="fortuneTitle" class="paper-title">Á•ûÁ±§</span>
          <span class="paper-ornament">‚óÜ</span>
        </div>
        
        <div class="fortune-content">
          <div class="fortune-text chinese" id="chineseText"></div>
          <div class="fortune-text thai" id="thaiText"></div>
        </div>
        
        <div class="additional-info">
          <div class="info-item">
            <span class="info-label">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•:</span>
            <span id="prizeNumber" class="info-value prize-number"></span>
          </div>
          <div class="info-item">
            <span class="info-label">‡πÇ‡∏ä‡∏Ñ‡∏™‡∏µ:</span>
            <span id="luckyColor" class="info-value"></span>
          </div>
          <div class="info-item">
            <span class="info-label">‡πÄ‡∏•‡∏Ç‡∏°‡∏á‡∏Ñ‡∏•:</span>
            <span id="luckyNumbers" class="info-value"></span>
          </div>
        </div>
        
        <div class="paper-footer">
          <div class="temple-seal">ÂØ∫</div>
        </div>
        
        <button id="drawAgainBtn" class="draw-again-btn">
          <span>‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Floating Elements -->
  <div class="floating-elements">
    <div class="floating-symbol symbol-1">Á¶è</div>
    <div class="floating-symbol symbol-2">Á•ø</div>
    <div class="floating-symbol symbol-3">Â£Ω</div>
    <div class="floating-symbol symbol-4">Âñú</div>
    <div class="floating-symbol symbol-5">Ë≤°</div>
  </div>

  <!-- Lanterns -->
  <div class="lantern lantern-left">
    <div class="lantern-body">
      <div class="lantern-text">Á¶è</div>
      <div class="lantern-bottom"></div>
    </div>
    <div class="lantern-string"></div>
  </div>
  
  <div class="lantern lantern-right">
    <div class="lantern-body">
      <div class="lantern-text">Á•ø</div>
      <div class="lantern-bottom"></div>
    </div>
    <div class="lantern-string"></div>
  </div>

  <!-- Admin Panel -->
  <div class="admin-panel">
    <div class="admin-toggle" id="adminToggle">
      <span class="admin-icon">ËÆæ</span>
    </div>
    
    <div class="admin-content" id="adminContent">
      <div class="admin-header">
        <h3>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç</h3>
        <button class="admin-close" id="adminClose">√ó</button>
      </div>
      
      <div class="admin-stats">
        <div class="stat-item">
          <span class="stat-label">‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏≠‡∏¢‡∏π‡πà:</span>
          <span class="stat-value" id="remainingCount"><%= @remaining_count %></span>
          <span class="stat-unit">‡∏ä‡∏¥‡πâ‡∏ô</span>
        </div>
      </div>
      
      <div class="admin-actions">
        <div class="delete-section">
          <label for="deleteNumber">‡∏•‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç:</label>
          <div class="input-group">
            <input type="number" id="deleteNumber" min="1" max="100" placeholder="‡πÉ‡∏™‡πà‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö">
            <button id="deleteBtn" class="delete-btn">‡∏•‡∏ö</button>
          </div>
        </div>
      </div>
      
      <div class="admin-message" id="adminMessage"></div>
    </div>
  </div>
</div>

<!-- Loading overlay -->
<div id="loadingOverlay" class="loading-overlay hidden">
  <div class="loading-content">
    <div class="fortune-shaker">
      <div class="shaker-container">
        <!-- ‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ -->
        <div class="shaker-tube">
          <div class="tube-top"></div>
          <div class="tube-body">
            <div class="tube-label">Á•ûÁ±§</div>
            <!-- ‡πÑ‡∏°‡πâ‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ‡πÉ‡∏ô‡∏Å‡∏£‡∏∞‡∏ö‡∏≠‡∏Å (‡∏¢‡πâ‡∏≤‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô tube-body ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏±‡∏î overflow) -->
            <div class="stick-in-tube stick-1"></div>
            <div class="stick-in-tube stick-2"></div>
            <div class="stick-in-tube stick-3"></div>
            <div class="stick-in-tube stick-4"></div>
            <div class="stick-in-tube stick-5"></div>
          </div>
        </div>
        
        <!-- ‡πÑ‡∏°‡πâ‡∏ó‡∏µ‡πà‡∏´‡∏•‡πà‡∏ô‡∏≠‡∏≠‡∏Å‡∏°‡∏≤ -->
        <div class="falling-stick">
          <div class="falling-stick-tip"></div>
          <div class="falling-stick-body">
            <div class="falling-stick-number">42</div>
          </div>
        </div>
      </div>
    </div>
    <div class="loading-text">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡∏¢‡πà‡∏≤‡πÄ‡∏ã‡∏µ‡∏¢‡∏°‡∏ã‡∏µ...</div>
  </div>
</div>

<%= javascript_import_module_tag "fortune" %>
