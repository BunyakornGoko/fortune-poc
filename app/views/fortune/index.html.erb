<% content_for :title, "เสี่ยงเซียมซี - Chinese Fortune" %>
<% content_for :full_page, true %>

<div class="fortune-container">
  <!-- Header with Chinese decorations -->
  <div class="header-section">
    <div class="chinese-ornament">龍</div>
    <h1 class="main-title">
      <span class="chinese-text">求籤問卜</span>
      <span class="thai-text">เซียมซี รับทรัพย์ รับโชค</span>
    </h1>
    <div class="chinese-ornament">鳳</div>
  </div>

  <!-- Fortune Stick Container -->
  <div class="fortune-stick-container">
    <div class="temple-background">
      <div class="incense-smoke"></div>
      <div class="incense-smoke delay-1"></div>
      <div class="incense-smoke delay-2"></div>
    </div>
    
    <div class="fortune-sticks" id="fortuneSticks">
      <% 20.times do |i| %>
        <div class="stick stick-<%= i + 1 %>" data-stick="<%= i + 1 %>">
          <div class="stick-tip-number"><%= i + 1 %></div>
        </div>
      <% end %>
    </div>
    
    <div class="fortune-box">
      <div class="box-decoration">福</div>
    </div>
  </div>

  <!-- Action Button -->
  <div class="action-section">
    <button id="drawFortuneBtn" class="draw-fortune-btn">
      <span class="btn-chinese">求籤</span>
      <span class="btn-thai">เสี่ยงเซียมซี</span>
      <div class="btn-glow"></div>
    </button>
  </div>

  <!-- Fortune Result (Modal) -->
  <div id="fortuneResult" class="fortune-result modal-overlay hidden" role="dialog" aria-modal="true" aria-labelledby="fortuneTitle">
    <div class="result-container">
      <div class="fortune-paper">
        <button id="closeResultBtn" class="modal-close-btn" aria-label="ปิดผลลัพธ์">×</button>
        <div class="paper-header">
          <span class="paper-ornament">◆</span>
          <span id="fortuneTitle" class="paper-title">神籤</span>
          <span class="paper-ornament">◆</span>
        </div>
        
        <div class="fortune-content">
          <div class="fortune-text chinese" id="chineseText"></div>
          <div class="fortune-text thai" id="thaiText"></div>
        </div>
        
        <div class="additional-info">
          <div class="info-item">
            <span class="info-label">หมายเลขของรางวัล:</span>
            <span id="prizeNumber" class="info-value prize-number"></span>
          </div>
          <div class="info-item">
            <span class="info-label">โชคสี:</span>
            <span id="luckyColor" class="info-value"></span>
          </div>
          <div class="info-item">
            <span class="info-label">เลขมงคล:</span>
            <span id="luckyNumbers" class="info-value"></span>
          </div>
        </div>
        
        <div class="paper-footer">
          <div class="temple-seal">寺</div>
        </div>
        
        <button id="drawAgainBtn" class="draw-again-btn">
          <span>อีกครั้ง</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Floating Elements -->
  <div class="floating-elements">
    <div class="floating-symbol symbol-1">福</div>
    <div class="floating-symbol symbol-2">祿</div>
    <div class="floating-symbol symbol-3">壽</div>
    <div class="floating-symbol symbol-4">喜</div>
    <div class="floating-symbol symbol-5">財</div>
  </div>

  <!-- Lanterns -->
  <div class="lantern lantern-left">
    <div class="lantern-body">
      <div class="lantern-text">福</div>
      <div class="lantern-bottom"></div>
    </div>
    <div class="lantern-string"></div>
  </div>
  
  <div class="lantern lantern-right">
    <div class="lantern-body">
      <div class="lantern-text">祿</div>
      <div class="lantern-bottom"></div>
    </div>
    <div class="lantern-string"></div>
  </div>

  <!-- Admin Panel -->
  <div class="admin-panel">
    <div class="admin-toggle" id="adminToggle">
      <span class="admin-icon">设</span>
    </div>
    
    <div class="admin-content" id="adminContent">
      <div class="admin-header">
        <h3>จัดการตัวเลข</h3>
        <button class="admin-close" id="adminClose">×</button>
      </div>
      
      <div class="admin-stats">
        <div class="stat-item">
          <span class="stat-label">เหลืออยู่:</span>
          <span class="stat-value" id="remainingCount"><%= @remaining_count %></span>
          <span class="stat-unit">ชิ้น</span>
        </div>
      </div>
      
      <div class="admin-actions">
        <div class="delete-section">
          <label for="deleteNumber">ลบตัวเลข:</label>
          <div class="input-group">
            <input type="number" id="deleteNumber" min="1" max="100" placeholder="ใส่หมายเลขที่ต้องการลบ">
            <button id="deleteBtn" class="delete-btn">ลบ</button>
          </div>
        </div>
      </div>
      
      <div class="admin-message" id="adminMessage"></div>
    </div>
  </div>
</div>

<!-- Loading overlay -->
<div id="loadingOverlay" class="loading-overlay hidden">
  <div class="loading-content">
    <div class="fortune-shaker">
      <div class="shaker-container">
        <!-- กระบอกเซียมซี -->
        <div class="shaker-tube">
          <div class="tube-top"></div>
          <div class="tube-body">
            <div class="tube-label">神籤</div>
            <!-- ไม้เซียมซีในกระบอก (ย้ายเข้ามาใน tube-body เพื่อตัด overflow) -->
            <div class="stick-in-tube stick-1"></div>
            <div class="stick-in-tube stick-2"></div>
            <div class="stick-in-tube stick-3"></div>
            <div class="stick-in-tube stick-4"></div>
            <div class="stick-in-tube stick-5"></div>
          </div>
        </div>
        
        <!-- ไม้ที่หล่นออกมา -->
        <div class="falling-stick">
          <div class="falling-stick-tip"></div>
          <div class="falling-stick-body">
            <div class="falling-stick-number">42</div>
          </div>
        </div>
      </div>
    </div>
    <div class="loading-text">กำลังเขย่าเซียมซี...</div>
  </div>
</div>

<%= javascript_import_module_tag "fortune" %>
